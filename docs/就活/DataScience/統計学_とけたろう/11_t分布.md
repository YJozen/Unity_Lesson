7 正規分布
8 t分布
9 母平均の区間推定





仮説検定　　　正しくなくても仮説　　帰無仮説を仮定
　



72
78



帰無仮説　　否定したい仮設　　たまたま
対立仮説　　主張したい仮説　　効果はあった！

 





t分布




**t分布**は、統計学において非常に重要な確率分布の一つで、特に小さなサンプルサイズ（通常は30未満）での母平均の推定に使われます。正規分布に似た形をしており、サンプルの標本平均が母平均とどれくらい異なるかを測定するために用いられます。

### t分布の特徴
1. **正規分布に似た形**:
   - t分布は**左右対称**で、**鐘形**の曲線をしています。しかし、正規分布と異なり、**裾（tails）が太い**です。これは、小さなサンプルサイズで得られた標本平均が母平均から大きく外れやすいことを反映しています。

2. **自由度**（Degrees of Freedom, df）:
   - t分布の重要な特徴は「自由度」です。自由度は通常、標本のサイズに基づいて計算されます。自由度は、サンプルのサイズ（n）から1を引いた値で計算されます（**df = n - 1**）。
   - 自由度が大きくなるほど、t分布は正規分布に近づきます。サンプルサイズが大きい場合、t分布はほとんど正規分布と同じ形になります。

3. **裾が広い**:
   - t分布は、標本サイズが小さい場合、**裾が太く**なります。これは、データのばらつきが大きいため、標本平均が母平均から遠くなる可能性があることを意味します。

4. **使用される場面**:
   - t分布は主に、**母平均の推定**や**2つの母平均の差の検定**に使用されます。特に、標本サイズが小さい場合や母分散がわからない場合に使用します。

### t分布の使用例

1. **t検定**（One-sample t-test, Two-sample t-test, Paired t-test）:
   - **1標本t検定**: サンプルの平均が、ある既知の母平均と異なるかを調べる検定です。
   - **2標本t検定**: 2つのサンプルが同じ母平均を持つかを調べる検定です。
   - **対応のあるt検定**: 同じ対象に対して2回以上の測定を行ったデータを比較するために使用します。

2. **信頼区間の推定**:
   - t分布は、サンプル平均の周りにある信頼区間を計算する際にも使われます。特に、標本サイズが小さい場合に正規分布ではなくt分布を使います。

### t分布の式
t分布の確率密度関数は、次のように表されます：

\[
t = \frac{\bar{X} - \mu}{S / \sqrt{n}}
\]

- \(\bar{X}\) はサンプル平均
- \(\mu\) は母平均（仮説の値）
- \(S\) はサンプルの標準偏差
- \(n\) はサンプルサイズ

この式では、サンプル平均 \(\bar{X}\) と母平均 \(\mu\) の差を、サンプル標準偏差 \(S\) と標本サイズ \(n\) を使って標準化しています。これによって、標本の分布をt分布に従うように変換しています。

### t分布のグラフ

t分布は、サンプルサイズが小さいときに裾が太く、自由度が増えるとだんだん正規分布に近づいていきます。自由度が大きい場合、t分布と正規分布はほとんど同じ形になります。

### t分布を使ったPythonの例

例えば、サンプルデータから母平均と比較してt検定を行いたい場合、`scipy.stats` ライブラリを使用することができます。

```python
import scipy.stats as stats

# サンプルデータ
data = [23, 21, 22, 25, 24, 23, 22, 23, 25, 24]

# 母平均（仮説値）
mu = 23

# サンプルの平均と標準偏差
sample_mean = np.mean(data)
sample_std = np.std(data, ddof=1)
n = len(data)

# t値の計算
t_stat = (sample_mean - mu) / (sample_std / np.sqrt(n))

# 自由度
df = n - 1

# p値の計算（両側検定）
p_value = 2 * (1 - stats.t.cdf(abs(t_stat), df))

print("t値:", t_stat)
print("p値:", p_value)
```

### 結論

t分布は、サンプルサイズが小さい場合に、サンプルの平均と母平均の差を評価するために使用されます。t分布の裾が広いため、標本のばらつきが大きい場合でも柔軟に対応できます。特に、母分散が不明である場合に非常に有用です。t分布を利用することで、母集団のパラメータに関する推定を行う際の信頼性を高めることができます。




