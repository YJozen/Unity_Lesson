一元配置分散分析


**一元配置分散分析**（いちげんはいちぶんさんぶんせき、One-Way ANOVA）は、複数のグループ間で平均値に差があるかどうかを検定する統計的手法です。この手法を使うことで、複数のグループ（カテゴリー）が同じ母集団から来ているか、それとも異なる母集団から来ているのかを確認することができます。

### 一元配置分散分析（One-Way ANOVA）の目的
例えば、3種類の異なる薬（A、B、C）が治療に対する効果が異なるかどうかを調べたい場合、各薬を投与されたグループの平均効果が同じか、異なるかを比較するために一元配置分散分析を使います。

### 一元配置分散分析の前提条件
1. **独立性**: 各グループは互いに独立している必要があります。
2. **正規性**: 各グループのデータは正規分布に従っている必要があります。
3. **等分散性**: 各グループの分散が同じである（またはほぼ同じ）必要があります。

### 一元配置分散分析の手順

1. **帰無仮説と対立仮説の設定**:
   - 帰無仮説（\(H_0\)）: 各グループの平均に差はない（平均が同じである）。
   - 対立仮説（\(H_1\)）: 少なくとも1つのグループの平均が他のグループと異なる。

2. **データの収集と整理**:
   各グループ（薬A、薬B、薬C）のデータを収集します。

3. **分散の計算**:
   分散分析では、データのばらつきを**全体の分散**、**グループ間の分散**、**グループ内の分散**に分けて考えます。

4. **F値の計算**:
   F値は、グループ間の変動（差）とグループ内の変動（ばらつき）を比較した値です。F値が大きいほど、グループ間に差がある可能性が高いということを示します。

   \[
   F = \frac{\text{グループ間の平方和（SSB）} / \text{自由度（dfB）}}{\text{グループ内の平方和（SSW）} / \text{自由度（dfW）}}
   \]

5. **F分布を使って有意性を判定**:
   計算されたF値とF分布を基に、帰無仮説を棄却するかどうかを決定します。有意水準（通常は0.05）を設定し、F値が有意水準に基づく臨界値を超えれば、帰無仮説を棄却し、グループ間に差があると結論します。

### 一元配置分散分析の結果の解釈

- **F値**: F値が大きければ、グループ間に差がある可能性が高くなります。逆に、F値が小さければ、グループ間に差はないと結論されます。
- **p値**: p値は、帰無仮説が正しいとした場合に、得られたデータが観察される確率です。p値が有意水準（例えば、0.05）より小さい場合、帰無仮説を棄却します。

### 一元配置分散分析の例

たとえば、3つの異なる運動方法（ウォーキング、ジョギング、サイクリング）が体重減少に与える影響を比較したいとき、各運動方法に従ったグループの体重減少量のデータを収集します。その後、各グループの平均体重減少量に差があるかどうかを一元配置分散分析を使って調べます。

### Pythonでの実施例

```python
import scipy.stats as stats
import numpy as np

# 各グループのデータ（ウォーキング、ジョギング、サイクリングの体重減少量）
group1 = [2.1, 2.5, 2.3, 2.8, 3.0]  # ウォーキング
group2 = [3.2, 3.4, 3.0, 3.6, 3.8]  # ジョギング
group3 = [1.9, 2.0, 2.2, 2.3, 2.1]  # サイクリング

# 一元配置分散分析の実行
f_value, p_value = stats.f_oneway(group1, group2, group3)

print(f"F値: {f_value}, p値: {p_value}")

# p値の解釈
if p_value < 0.05:
    print("グループ間に有意な差があります。")
else:
    print("グループ間に有意な差はありません。")
```

### 結果の解釈

- **F値**: もしF値が高ければ、グループ間に有意な差がある可能性が高いです。
- **p値**: p値が0.05より小さければ、帰無仮説を棄却し、グループ間に差があると結論できます。

---

### まとめ

一元配置分散分析（One-Way ANOVA）は、3つ以上のグループの平均値に差があるかどうかを検定するための手法です。この方法を使うと、グループ間で統計的に有意な違いがあるかどうかを確認できます。F値を使って検定を行い、得られたp値に基づいて帰無仮説を棄却するかどうかを決定します。









**F値**（F-value）は、統計学における分散分析（ANOVA）で用いられる指標で、グループ間の変動とグループ内の変動を比較するために使われます。F値が大きいほど、グループ間に有意な差がある可能性が高いことを示唆します。

### F値の定義
F値は、次のように計算されます：

\[
F = \frac{\text{グループ間の平方和（SSB）} / \text{自由度（dfB）}}{\text{グループ内の平方和（SSW）} / \text{自由度（dfW）}}
\]

- **グループ間の平方和（SSB, Sum of Squares Between groups）**: 各グループの平均と全体の平均との偏差の二乗の和です。この値は、グループ間の変動（差異）を示します。
  
- **グループ内の平方和（SSW, Sum of Squares Within groups）**: 各グループ内のデータポイントがそのグループの平均からどれだけ離れているかを示す変動です。個々のグループ内のばらつきを表します。

- **自由度（df）**: 自由度は、データの中で独立して動くことができる値の数です。
  - グループ間自由度（dfB）は、グループ数 - 1（\(k - 1\)）です。
  - グループ内自由度（dfW）は、データポイント数 - グループ数（\(n - k\)）です。

### F値の解釈

- **F値が大きい**: グループ間の変動（差異）がグループ内の変動に比べて大きい場合、F値は大きくなります。これにより、グループ間に有意な差があると判断される可能性が高くなります。

- **F値が小さい**: グループ間の変動が小さく、グループ内の変動が大きい場合、F値は小さくなります。これは、グループ間に有意な差がない、つまり帰無仮説（グループ間に差はない）が支持されることを示唆します。

### F値の計算例

例えば、3つのグループ（グループA、グループB、グループC）についての体重データを使って、F値を計算するシナリオを考えます。

1. 各グループの平均体重を計算し、それぞれのグループの体重のデータがそのグループの平均からどれだけ離れているか（グループ内の変動）を求めます。
2. その後、各グループの平均体重が全体の平均体重からどれだけ離れているか（グループ間の変動）を求めます。
3. 最後に、これらの値を使ってF値を計算します。

### F分布とF値の関連

F値の計算結果は、**F分布**に従います。F分布は、自由度に基づいて形が決まる確率分布です。F分布を使って、計算されたF値が有意であるかどうかを判断するために、p値を計算します。

- **p値が小さい**（通常、0.05以下）場合、帰無仮説を棄却し、グループ間に有意な差があると結論します。
- **p値が大きい**場合、帰無仮説を棄却できず、グループ間に有意な差がないと結論します。

### まとめ

F値は、分散分析（ANOVA）で使用され、グループ間とグループ内の変動を比較するために使われます。F値が大きいほど、グループ間に有意な差があると考えられます。F値が計算されると、それに基づいてp値が算出され、帰無仮説を棄却するかどうかを判断します。




水準内平均
全体の平均
水準間平方和
残差平方和








